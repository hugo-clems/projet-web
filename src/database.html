<!DOCTYPE HTML>
	<html>

		<head>
			<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
			<script type="text/javascript">

				//Liste des années lol
				var annee = [1990,2000,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016];
				//Ouverture du JSON pour
				$.getJSON('pib_pays.json', function(data) {
					// Création de la table contenant les objets des Pays (PIB/DATE)
					var pibPays = [];
					$.each(data, function(key,val){
						// On enlève les lignes vide
						if(val["Country Name"] != ""){
							//Création de la liste contenant les objets avec attributs Date / PIB
							var datePIB = [];
							// On rempli la liste avec totue les dates
							$.each(val,function(key2,val2){
								if(key2[0] == 1 || key2[0] == 2){
									datePIB.push({date:key2,pib:val2});
								}
							});
							//On ajoute les données dans notre liste (une par une ofc)
							pibPays.push({nomPays: val["Country Name"], valeur: datePIB})
						}
					});

				});

				//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
				//         /!\ INIT DB /!\
				//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
				//prefixes of implementation that we want to test
				window.indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB ||window.msIndexedDB;

				//prefixes of window.IDB objects
				window.IDBTransaction = window.IDBTransaction || window.webkitIDBTransaction || window.msIDBTransaction;
				window.IDBKeyRange = window.IDBKeyRange || window.webkitIDBKeyRange || window.msIDBKeyRange

				if (!window.indexedDB) {
					window.alert("Your browser doesn't support a stable version of IndexedDB.")
				}

				var db;
				// On ouvre la base qu'on nomme et on lui donne un n° de version. 
				var request = window.indexedDB.open("PaysDB", 1);

				// Call back de l'erreur pour création de la  base
				request.onerror = function(event) {
					console.log("error: ");
				};
				// Call back de la réussite pour création de la base
				request.onsuccess = function(event) {
					// On enregistre le resultat de la requête dans la base 
					db = request.result;
					console.log("success: "+ db);
				};

				

				// Si base existe déjà lors de la création de la base, appelé tout le temps 
				request.onupgradeneeded = function(event) {

					var db = event.target.result;
					var paysTable = db.createObjectStore("Pays", {keyPath: "nomPays"});
					var anneeTable = db.createObjectStore("Annee", {keyPath: "annee"});
					var continentTable = db.createObjectStore("Continent", {keyPath: "nomContinent"});
					var pibTable = db.createObjectStore("PIB", {keyPath: ["nomPaysPIB","anneePIB"]});



				}
			</script>

		</head>

		<body>

		</body>

</html>
