<!DOCTYPE html>
<html>
  <head>
	<!-- jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <div id="map"></div>
	<h3>Pays sélectionnés : </h3>
	<ul id="myliste">
    </ul>
    <script type="text/javascript">
var map;
var albi = {lat: 43.919367, lng: 2.138310};
var listeName=[];
var world_geometry= null;

<!-- Initilisation de la map et des fonctions liées à la map -->
function initMap() {
  map = new google.maps.Map(document.getElementById('map'), {
    center: albi,
    zoom: 4,
	zoomControl: true,
	maxZoom : 9,
	minZoom : 3,
	mapTypeControl: false,
	scaleControl: false,
	streetViewControl: false,
	rotateControl: false
  });
  <!-- Lors du clic sur la map , place un marker avec sa position -->
  google.maps.event.addListener(map, 'click', function(event) {
    placeMarker(event.latLng);
  }); 
} 

<!-- Fonction qui place un marqueur à la location puis qui appelle la fonction get country -->
function placeMarker(location) {
  var marker = new google.maps.Marker({ 
      position: location,
      map: map
  }); 
  getCountry(location);    
}

<!-- Récupère le nom(long) du pays et son nom(court) (ex : FR ou UK) -->
<!-- et ajoute son nom(long) à la liste des pays ainsi que surligne le pays sur la carte grâce à son nom court -->
function getCountry (location) {
	var lat = location.lat();
	var lng = location.lng();
	var countryName;
	var countryShortName;
 	$.getJSON('http://maps.googleapis.com/maps/api/geocode/json?latlng='+lat+','+lng+'&sensor=false')
			.done (function(location)
			{
			var i = 2;
      if (location.results) {
        var country = location.results[location.results.length-1].address_components[0];
        var countryName = country.long_name;
        var countryCode = country.short_name;
      }

      listeName.push(countryCode);
      $('ul').append('<li>'+countryName+'</li>')

      var strList = JSON.stringify(listeName);
      var param = strList.substr(1, strList.length-2).replace(/\"/g,'\'');

      if (world_geometry != null) world_geometry.setMap(null);

      world_geometry = new google.maps.FusionTablesLayer({
        query: {
          select: 'geometry',
          from: '1N2LBk4JHwWpOY4d9fobIn27lfnZ5MDy-NoqqRpk',
          where: "ISO_2DIGIT IN ("+param+")"
        },
        styles : [{polygonOptions : {fillColor : "#FFFFFF",
  							  strokeWeight : 1}}],
        suppressInfoWindows: true,
      });
      world_geometry.setMap(map);
		});
}

<!-- Ajoute un pays à la liste des pays -->
function addCountryList(country) {
		var ma_liste = document.getElementById("myliste");
		var li = document.createElement("li");
		var pays = document.createTextNode(country); 
		li.appendChild(pays);  
		ma_liste.appendChild(li);
}		

<!-- Affiche les polygones des pays placés en paramètre (liste de la forme 'UK','FR','DE' etc ) -->
<!-- TODO résoudre problème : Ne passe pas plusieurs fois dans le world geometry , peut etre un pb de call back encore -->
<!-- doc sur l'objet fusiontablelayer : https://www.touraineverte.fr/google-maps-api-version-3/reference/FusionTablesStyle.html#propriete-polygonOptions -->
<!-- https://developers.google.com/maps/documentation/javascript/fusiontableslayer?hl=fr -->
<!-- https://www.touraineverte.fr/google-maps-api-version-3/reference/FusionTablesLayerOptions.html#FusionTablesLayerOptions -->
<!-- tuto que j'ai utilisé : http://stackoverflow.com/questions/8670859/highlight-whole-countries-in-google-maps -->

function selectPays(listeName) {
console.log(listeName);


  world_geometry = new google.maps.FusionTablesLayer({
  query: {
    select: 'geometry',
    from: '1N2LBk4JHwWpOY4d9fobIn27lfnZ5MDy-NoqqRpk',
    where: "ISO_2DIGIT IN ("+listeName+")"
	
  },
  styles : [{polygonOptions : {fillColor : "#FFFFFF",
							  strokeWeight : 1}}],
  suppressInfoWindows: true,
  map: map
});
console.log(world_geometry);
}

$(document).ready(function() {
	$('a').click(function(){
		map.setStreetView(null);
	});
});
    </script>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAt880iw5HS2GPerK_RZ1K-Qt5NneaP-_8&callback=initMap">
    </script>
  </body>
</html>
